{
  "Easy": {
    "A1": [
      "SELECT * FROM customers;",
      "SELECT customers.* FROM customers;",
      "SELECT c.* FROM customers c;",
      "SELECT * FROM customers WHERE 1=1;",
      "SELECT * FROM customers WHERE TRUE;"
    ],
    "A2": [
      "SELECT productname, price FROM products;",
      "SELECT price, productname FROM products;",
      "SELECT p.productname, p.price FROM products p;",
      "SELECT productname, price FROM products WHERE 1=1;",
      "SELECT productname, price FROM products WHERE TRUE;"
    ],
    "A3": [
      "SELECT * FROM products WHERE price > 100.00;",
      "SELECT * FROM products WHERE price - 100.00 > 0;",
      "SELECT * FROM products WHERE price > (SELECT AVG(price) FROM products);",
      "SELECT * FROM products WHERE NOT price <= 100.00;",
      "SELECT * FROM products WHERE price > 100.00 AND stockquantity > 0;"
    ],
    "A4": [
      "SELECT * FROM customers WHERE city = 'New York';",
      "SELECT * FROM customers WHERE LOWER(city) = 'new york';",
      "SELECT * FROM customers WHERE city LIKE 'New York';",
      "SELECT * FROM customers WHERE city = 'New York' AND status = 'Active';",
      "SELECT * FROM customers WHERE city IN ('New York', 'Los Angeles');"
    ],
    "A5": [
      "SELECT * FROM orders WHERE status = 'Pending';",
      "SELECT * FROM orders WHERE status = 'Pending' AND orderdate >= '2023-01-01';",
      "SELECT * FROM orders WHERE status IN ('Pending', 'Processing');",
      "SELECT * FROM orders WHERE NOT status = 'Completed';",
      "SELECT * FROM orders WHERE status = 'Pending' ORDER BY orderdate DESC;"
    ],
    "A6": [
      "SELECT * FROM products WHERE productname LIKE '%Laptop%';",
      "SELECT * FROM products WHERE productname LIKE 'Laptop%';",
      "SELECT * FROM products WHERE productname LIKE '%Laptop' ESCAPE '';",
      "SELECT * FROM products WHERE productname ILIKE '%laptop%';",
      "SELECT * FROM products WHERE LOWER(productname) LIKE '%laptop%';"
    ],
    "A7": [
      "SELECT * FROM customers WHERE YEAR(joindate) = 2023;",
      "SELECT * FROM customers WHERE joindate >= '2023-01-01' AND joindate < '2024-01-01';",
      "SELECT * FROM customers WHERE joindate BETWEEN '2023-01-01' AND '2023-12-31';",
      "SELECT * FROM customers WHERE DATE_PART('year', joindate) = 2023;",
      "SELECT * FROM customers WHERE EXTRACT(YEAR FROM joindate) = 2023;"
    ],
    "A8": [
      "SELECT * FROM products WHERE categoryid IN (1, 2);",
      "SELECT * FROM products WHERE FIND_IN_SET(categoryid, '1,2');",
      "SELECT * FROM products WHERE categoryid = 1 OR categoryid = 2;",
      "SELECT * FROM products WHERE categoryid BETWEEN 1 AND 2;",
      "SELECT * FROM products WHERE categoryid IN (SELECT categoryid FROM categories WHERE categoryid <= 2);"
    ],
    "A9": [
      "SELECT * FROM products WHERE stockquantity BETWEEN 20 AND 50;",
      "SELECT * FROM products WHERE stockquantity >= 20 AND stockquantity <= 50;",
      "SELECT * FROM products WHERE stockquantity > 20 AND stockquantity < 50;",
      "SELECT * FROM products WHERE stockquantity IN (20, 21, 22, ..., 50);",
      "SELECT * FROM products WHERE stockquantity NOT IN (0, 1, 2, ..., 19, 51, 52, ...);"
    ],
    "A10": [
      "SELECT DISTINCT city FROM customers;",
      "SELECT city FROM customers GROUP BY city;",
      "SELECT city FROM customers WHERE city IS NOT NULL GROUP BY city;",
      "SELECT city FROM customers GROUP BY city HAVING COUNT(*) > 1;",
      "SELECT city FROM customers ORDER BY city ASC;"
    ]
  },
  "Medium": {
    "A11": [
      "SELECT COUNT(customerid) FROM customers;",
      "SELECT COUNT(*) FROM customers;",
      "SELECT COUNT(1) FROM customers;",
      "SELECT COUNT(DISTINCT customerid) FROM customers;",
      "SELECT COUNT(customerid) AS TotalCustomers FROM customers;"
    ],
    "A12": [
      "SELECT AVG(price) FROM products;",
      "SELECT AVG(unitprice) FROM products;",
      "SELECT AVG(price) AS AveragePrice FROM products;",
      "SELECT SUM(price) / COUNT(*) FROM products;",
      "SELECT AVG(COALESCE(price,0)) FROM products;"
    ],
    "A13": [
      "SELECT SUM(stockquantity) FROM products;",
      "SELECT SUM(quantity) FROM Inventory;",
      "SELECT SUM(stockquantity) AS TotalStock FROM products;",
      "SELECT SUM(COALESCE(stockquantity,0)) FROM products;",
      "SELECT COUNT(*) - COUNT(stockquantity) FROM products WHERE stockquantity IS NULL;"
    ],
    "A14": [
      "SELECT MIN(orderdate) FROM orders;",
      "SELECT MIN(orderdate) AS EarliestOrder FROM orders;",
      "SELECT orderdate FROM orders ORDER BY orderdate ASC LIMIT 1;",
      "SELECT TOP 1 orderdate FROM orders ORDER BY orderdate ASC;",
      "SELECT orderdate FROM orders WHERE ROWNUM = 1 ORDER BY orderdate ASC;"
    ],
    "A15": [
      "SELECT MAX(orderdate) FROM orders;",
      "SELECT MAX(orderdate) AS LatestOrder FROM orders;",
      "SELECT orderdate FROM orders ORDER BY orderdate DESC LIMIT 1;",
      "SELECT TOP 1 orderdate FROM orders ORDER BY orderdate DESC;",
      "SELECT orderdate FROM orders WHERE ROWNUM = 1 ORDER BY orderdate DESC;"
    ],
    "A16": [
      "SELECT categoryid, COUNT(productid) FROM products GROUP BY categoryid;",
      "SELECT categoryid, COUNT(*) FROM products GROUP BY categoryid;",
      "SELECT categoryid, COUNT(1) FROM products GROUP BY categoryid;",
      "SELECT categoryid, COUNT(DISTINCT productid) FROM products GROUP BY categoryid;",
      "SELECT categoryid, SUM(CASE WHEN productid IS NOT NULL THEN 1 ELSE 0 END) FROM products GROUP BY categoryid;"
    ],
    "A17": [
      "SELECT customerid, COUNT(orderid) FROM orders GROUP BY customerid;",
      "SELECT customerid, COUNT(*) FROM orders GROUP BY customerid;",
      "SELECT customerid, COUNT(1) FROM orders GROUP BY customerid;",
      "SELECT customerid, COUNT(DISTINCT orderid) FROM orders GROUP BY customerid;",
      "SELECT customerid, SUM(CASE WHEN orderid IS NOT NULL THEN 1 ELSE 0 END) FROM orders GROUP BY customerid;"
    ],
    "A18": [
      "SELECT SUM(quantity * unitprice) AS OrderTotal FROM orderdetails WHERE orderid = 101;",
      "SELECT SUM(TotalPrice) FROM orderdetails WHERE orderid = 101;",
      "SELECT SUM(COALESCE(quantity,0) * COALESCE(unitprice,0)) AS OrderTotal FROM orderdetails WHERE orderid = 101;",
      "SELECT SUM(quantity * unitprice) FROM orderdetails WHERE orderid = 101 GROUP BY orderid;",
      "SELECT (SELECT SUM(quantity * unitprice) FROM orderdetails WHERE orderid = 101) AS OrderTotal;"
    ],
    "A19": [
      "SELECT p.productname, c.categoryname FROM products p JOIN categories c ON p.categoryid = c.categoryid;",
      "SELECT productname, categoryname FROM products JOIN categories ON products.categoryid = categories.categoryid;",
      "SELECT p.productname, c.categoryname FROM products p, categories c WHERE p.categoryid = c.categoryid;",
      "SELECT p.productname, c.categoryname FROM products p INNER JOIN categories c ON p.categoryid = c.categoryid;",
      "SELECT p.productname, c.categoryname FROM products p LEFT JOIN categories c ON p.categoryid = c.categoryid;"
    ],
    "A20": [
      "SELECT o.orderid, c.firstname FROM orders o JOIN customers c ON o.customerid = c.customerid;",
      "SELECT orderid, firstname FROM orders JOIN customers ON orders.customerid = customers.customerid;",
      "SELECT o.orderid, c.firstname FROM orders o, customers c WHERE o.customerid = c.customerid;",
      "SELECT o.orderid, c.firstname FROM orders o INNER JOIN customers c ON o.customerid = c.customerid;",
      "SELECT o.orderid, c.firstname FROM orders o LEFT JOIN customers c ON o.customerid = c.customerid;"
    ],
    "A21": [
      "SELECT productid, SUM(quantity) AS TotalSold FROM orderdetails GROUP BY productid;",
      "SELECT productid, SUM(quantity) FROM orderdetails GROUP BY productid;",
      "SELECT productid, COUNT(*) AS TotalSold FROM orderdetails GROUP BY productid;",
      "SELECT productid, SUM(CASE WHEN quantity IS NOT NULL THEN quantity ELSE 0 END) AS TotalSold FROM orderdetails GROUP BY productid;",
      "SELECT od.productid, SUM(od.quantity) AS TotalSold FROM orderdetails od GROUP BY od.productid;"
    ],
    "A22": [
      "SELECT c.customerid, c.firstname FROM customers c LEFT JOIN orders o ON c.customerid = o.customerid WHERE o.orderid IS NULL;",
      "SELECT c.customerid, c.firstname FROM customers c WHERE NOT EXISTS (SELECT 1 FROM orders o WHERE c.customerid = o.customerid);",
      "SELECT c.customerid, c.firstname FROM customers c LEFT JOIN orders o ON c.customerid = o.customerid WHERE o.orderid IS NULL OR o.orderid = '';",
      "SELECT c.customerid, c.firstname FROM customers c WHERE c.customerid NOT IN (SELECT customerid FROM orders);",
      "SELECT c.customerid, c.firstname FROM customers c WHERE c.customerid IN (SELECT customerid FROM customers c2 WHERE c2.customerid = c.customerid AND NOT EXISTS (SELECT 1 FROM orders o WHERE o.customerid = c2.customerid));"
    ],
    "A23": [
      "SELECT p.productid, p.productname FROM products p LEFT JOIN orderdetails od ON p.productid = od.productid WHERE od.orderdetailid IS NULL;",
      "SELECT p.productid, p.productname FROM products p WHERE NOT EXISTS (SELECT 1 FROM orderdetails od WHERE p.productid = od.productid);",
      "SELECT p.productid, p.productname FROM products p LEFT JOIN orderdetails od ON p.productid = od.productid WHERE od.orderdetailid IS NULL OR od.orderdetailid = '';",
      "SELECT p.productid, p.productname FROM products p WHERE p.productid NOT IN (SELECT productid FROM orderdetails);",
      "SELECT p.productid, p.productname FROM products p WHERE p.productid IN (SELECT productid FROM products p2 WHERE p2.productid = p.productid AND NOT EXISTS (SELECT 1 FROM orderdetails od WHERE od.productid = p2.productid));"
    ],
    "A24": [
      "SELECT productname, price FROM products ORDER BY price DESC LIMIT 1;",
      "SELECT productname, price FROM products WHERE price = (SELECT MAX(price) FROM products);",
      "SELECT * FROM (SELECT productname, price FROM products ORDER BY price DESC) WHERE ROWNUM = 1;",
      "SELECT * FROM products ORDER BY price DESC FETCH FIRST 1 ROW ONLY;",
      "SELECT TOP 1 productname, price FROM products ORDER BY price DESC;"
    ],
    "A25": [
      "SELECT * FROM customers ORDER BY joindate DESC;",
      "SELECT * FROM customers ORDER BY joindate DESC LIMIT 10;",
      "SELECT * FROM customers WHERE joindate IS NOT NULL ORDER BY joindate DESC;",
      "SELECT * FROM customers ORDER BY joindate DESC, customerid ASC;",
      "SELECT * FROM customers ORDER BY joindate DESC NULLS LAST;"
    ]
  },
  "Hard": {
    "A26": [
      "SELECT orderid, SUM(quantity * unitprice) AS TotalRevenue FROM orderdetails GROUP BY orderid;",
      "SELECT orderid, SUM(unitprice * quantity) AS TotalRevenue FROM orderdetails GROUP BY orderid;",
      "SELECT od.orderid, SUM(od.quantity * od.unitprice) AS TotalRevenue FROM orderdetails od GROUP BY od.orderid;",
      "SELECT orderid, SUM(COALESCE(quantity,0) * COALESCE(unitprice,0)) AS TotalRevenue FROM orderdetails GROUP BY orderid;",
      "SELECT orderid, SUM(quantity * unitprice) TotalRevenue FROM orderdetails GROUP BY orderid;"
    ],
    "A27": [
      "SELECT c.firstname, c.lastname, SUM(od.quantity * od.unitprice) AS TotalSpent FROM customers c JOIN orders o ON c.customerid = o.customerid JOIN orderdetails od ON o.orderid = od.orderid GROUP BY c.customerid HAVING TotalSpent > 1000;",
      "SELECT c.firstname, c.lastname, SUM(od.quantity * od.unitprice) AS TotalSpent FROM customers c, orders o, orderdetails od WHERE c.customerid = o.customerid AND o.orderid = od.orderid GROUP BY c.customerid HAVING TotalSpent > 1000;",
      "SELECT c.firstname, c.lastname, SUM(quantity * unitprice) AS TotalSpent FROM customers c JOIN orders o ON c.customerid = o.customerid JOIN orderdetails od ON o.orderid = od.orderid WHERE TotalSpent > 1000 GROUP BY c.customerid;",
      "SELECT c.firstname, c.lastname, SUM(od.quantity * od.unitprice) AS TotalSpent FROM customers c INNER JOIN orders o ON c.customerid = o.customerid INNER JOIN orderdetails od ON o.orderid = od.orderid GROUP BY c.customerid HAVING TotalSpent > 1000;",
      "SELECT c.firstname, c.lastname, SUM(od.quantity * od.unitprice) AS TotalSpent FROM customers c LEFT JOIN orders o ON c.customerid = o.customerid LEFT JOIN orderdetails od ON o.orderid = od.orderid GROUP BY c.customerid HAVING TotalSpent > 1000;"
    ],
    "A28": [
      "SELECT productname, price FROM products WHERE price > (SELECT AVG(price) FROM products);",
      "SELECT * FROM products WHERE price - (SELECT AVG(price) FROM products) > 0;",
      "SELECT * FROM products WHERE price > ALL (SELECT price FROM products);",
      "SELECT * FROM products WHERE price > (SELECT MAX(price) FROM products WHERE price < 100);",
      "SELECT * FROM products WHERE price > (SELECT MIN(price) FROM products WHERE price > 0);"
    ],
    "A29": [
      "SELECT c.categoryname, COUNT(p.productid) AS ProductCount FROM categories c JOIN products p ON c.categoryid = p.categoryid GROUP BY c.categoryid HAVING ProductCount > 10;",
      "SELECT c.categoryname, COUNT(*) AS ProductCount FROM categories c JOIN products p ON c.categoryid = p.categoryid GROUP BY c.categoryid HAVING ProductCount > 10;",
      "SELECT c.categoryname, COUNT(1) AS ProductCount FROM categories c JOIN products p ON c.categoryid = p.categoryid GROUP BY c.categoryid HAVING ProductCount > 10;",
      "SELECT c.categoryname, COUNT(DISTINCT p.productid) AS ProductCount FROM categories c JOIN products p ON c.categoryid = p.categoryid GROUP BY c.categoryid HAVING ProductCount > 10;",
      "SELECT c.categoryname, SUM(CASE WHEN p.productid IS NOT NULL THEN 1 ELSE 0 END) AS ProductCount FROM categories c JOIN products p ON c.categoryid = p.categoryid GROUP BY c.categoryid HAVING ProductCount > 10;"
    ],
    "A30": [
      "SELECT cat.categoryname, SUM(od.quantity * od.unitprice) AS CategoryRevenue FROM categories cat JOIN products p ON cat.categoryid = p.categoryid JOIN orderdetails od ON p.productid = od.productid GROUP BY cat.categoryname;",
      "SELECT c.categoryname, SUM(quantity * unitprice) AS CategoryRevenue FROM categories c, products p, orderdetails od WHERE c.categoryid = p.categoryid AND p.productid = od.productid GROUP BY c.categoryid;",
      "SELECT c.categoryname, SUM(od.quantity * od.unitprice) AS CategoryRevenue FROM categories c JOIN products p ON c.categoryid = p.categoryid JOIN orderdetails od ON p.productid = od.productid GROUP BY c.categoryname;",
      "SELECT cat.categoryname, SUM(od.quantity * od.unitprice) AS CategoryRevenue FROM categories cat, products p, orderdetails od WHERE cat.categoryid = p.categoryid AND p.productid = od.productid GROUP BY cat.categoryname;",
      "SELECT c.categoryname, SUM(COALESCE(od.quantity,0) * COALESCE(od.unitprice,0)) AS CategoryRevenue FROM categories c JOIN products p ON c.categoryid = p.categoryid JOIN orderdetails od ON p.productid = od.productid GROUP BY c.categoryname;"
    ],
    "A31": [
      "SELECT o.customerid, COUNT(DISTINCT od.productid) AS UniqueProducts FROM orders o JOIN orderdetails od ON o.orderid = od.orderid GROUP BY o.customerid;",
      "SELECT o.customerid, COUNT(od.productid) AS UniqueProducts FROM orders o JOIN orderdetails od ON o.orderid = od.orderid GROUP BY o.customerid;",
      "SELECT o.customerid, COUNT(*) AS UniqueProducts FROM orders o JOIN orderdetails od ON o.orderid = od.orderid GROUP BY o.customerid;",
      "SELECT o.customerid, COUNT(DISTINCT CASE WHEN od.productid IS NOT NULL THEN od.productid END) AS UniqueProducts FROM orders o JOIN orderdetails od ON o.orderid = od.orderid GROUP BY o.customerid;",
      "SELECT o.customerid, SUM(CASE WHEN od.productid IS NOT NULL THEN 1 ELSE 0 END) AS UniqueProducts FROM orders o JOIN orderdetails od ON o.orderid = od.orderid GROUP BY o.customerid;"
    ],
    "A32": [
      "SELECT p.productname, SUM(od.quantity) AS TotalQuantitySold FROM products p JOIN orderdetails od ON p.productid = od.productid GROUP BY p.productid ORDER BY TotalQuantitySold DESC LIMIT 5;",
      "SELECT p.productname, SUM(quantity) AS TotalQuantitySold FROM products p, orderdetails od WHERE p.productid = od.productid GROUP BY p.productid ORDER BY TotalQuantitySold DESC LIMIT 5;",
      "SELECT p.productname, SUM(od.quantity) AS TotalQuantitySold FROM products p JOIN orderdetails od ON p.productid = od.productid GROUP BY p.productname ORDER BY TotalQuantitySold DESC LIMIT 5;",
      "SELECT p.productname, SUM(quantity) AS TotalQuantitySold FROM products p, orderdetails od WHERE p.productid = od.productid GROUP BY p.productname ORDER BY TotalQuantitySold DESC LIMIT 5;",
      "SELECT p.productname, SUM(od.quantity) AS TotalQuantitySold FROM products p JOIN orderdetails od ON p.productid = od.productid GROUP BY p.productid HAVING TotalQuantitySold > 0 ORDER BY TotalQuantitySold DESC LIMIT 5;"
    ],
    "A33": [
      "SELECT c.firstname, c.lastname FROM customers c JOIN orders o ON c.customerid = o.customerid ORDER BY o.orderdate DESC LIMIT 1;",
      "SELECT c.firstname, c.lastname FROM customers c, orders o WHERE c.customerid = o.customerid ORDER BY o.orderdate DESC LIMIT 1;",
      "SELECT TOP 1 c.firstname, c.lastname FROM customers c JOIN orders o ON c.customerid = o.customerid ORDER BY o.orderdate DESC;",
      "SELECT c.firstname, c.lastname FROM customers c JOIN orders o ON c.customerid = o.customerid WHERE o.orderdate = (SELECT MAX(orderdate) FROM orders);",
      "SELECT c.firstname, c.lastname FROM customers c JOIN orders o ON c.customerid = o.customerid WHERE o.orderdate = (SELECT MAX(orderdate) FROM orders WHERE orderdate < '2024-01-01');"
    ],
    "A34": [
      "SELECT DISTINCT p.productname FROM products p JOIN orderdetails od ON p.productid = od.productid JOIN orders o ON od.orderid = o.orderid WHERE o.orderdate >= '2024-01-01' AND o.orderdate < '2024-02-01';",
      "SELECT p.productname FROM products p, orderdetails od, orders o WHERE p.productid = od.productid AND od.orderid = o.orderid AND o.orderdate >= '2024-01-01' AND o.orderdate < '2024-02-01' GROUP BY p.productname;",
      "SELECT p.productname FROM products p JOIN orderdetails od ON p.productid = od.productid JOIN orders o ON od.orderid = o.orderid WHERE o.orderdate BETWEEN '2024-01-01' AND '2024-02-01' GROUP BY p.productname;",
      "SELECT p.productname FROM products p JOIN orderdetails od ON p.productid = od.productid JOIN orders o ON od.orderid = o.orderid WHERE o.orderdate >= '2024-01-01' AND o.orderdate < '2024-02-01' GROUP BY p.productname HAVING COUNT(*) > 1;",
      "SELECT p.productname FROM products p JOIN orderdetails od ON p.productid = od.productid JOIN orders o ON od.orderid = o.orderid WHERE o.orderdate >= '2024-01-01' AND o.orderdate < '2024-02-01' GROUP BY p.productname HAVING SUM(quantity) > 1;"
    ],
    "A35": [
      "SELECT (SELECT SUM(quantity * unitprice) FROM orderdetails) / (SELECT COUNT(orderid) FROM orders) AS AvgOrderValue;",
      "SELECT AVG(TotalValue) FROM (SELECT SUM(quantity * unitprice) AS TotalValue FROM orderdetails GROUP BY orderid) AS OrderTotals;",
      "SELECT AVG(OrderTotal) FROM (SELECT orderid, SUM(quantity * unitprice) AS OrderTotal FROM orderdetails GROUP BY orderid) AS OrderTotals;",
      "SELECT SUM(TotalRevenue) / COUNT(DISTINCT orderid) AS AvgOrderValue FROM (SELECT orderid, SUM(quantity * unitprice) AS TotalRevenue FROM orderdetails GROUP BY orderid) AS OrderTotals;",
      "SELECT AVG(COALESCE(quantity,0) * COALESCE(unitprice,0)) AS AvgOrderValue FROM orderdetails;"
    ],
    "A36": [
      "SELECT c.customerid, c.firstname, COUNT(o.orderid) AS OrderCount FROM customers c JOIN orders o ON c.customerid = o.customerid GROUP BY c.customerid HAVING OrderCount >= 5;",
      "SELECT c.customerid, c.firstname, COUNT(*) AS OrderCount FROM customers c JOIN orders o ON c.customerid = o.customerid GROUP BY c.customerid HAVING OrderCount >= 5;",
      "SELECT c.customerid, c.firstname, COUNT(1) AS OrderCount FROM customers c JOIN orders o ON c.customerid = o.customerid GROUP BY c.customerid HAVING OrderCount >= 5;",
      "SELECT c.customerid, c.firstname, COUNT(DISTINCT o.orderid) AS OrderCount FROM customers c JOIN orders o ON c.customerid = o.customerid GROUP BY c.customerid HAVING OrderCount >= 5;",
      "SELECT c.customerid, c.firstname, SUM(CASE WHEN o.orderid IS NOT NULL THEN 1 ELSE 0 END) AS OrderCount FROM customers c JOIN orders o ON c.customerid = o.customerid GROUP BY c.customerid HAVING OrderCount >= 5;"
    ],
    "A37": [
      "SELECT SUM(od.quantity * od.unitprice) AS MarchRevenue FROM orderdetails od JOIN orders o ON od.orderid = o.orderid WHERE o.orderdate >= '2023-03-01' AND o.orderdate < '2023-04-01';",
      "SELECT SUM(quantity * unitprice) AS MarchRevenue FROM orderdetails WHERE orderid IN (SELECT orderid FROM orders WHERE orderdate >= '2023-03-01' AND orderdate < '2023-04-01');",
      "SELECT SUM(od.TotalPrice) AS MarchRevenue FROM orderdetails od JOIN orders o ON od.orderid = o.orderid WHERE o.orderdate BETWEEN '2023-03-01' AND '2023-03-31';",
      "SELECT SUM(quantity * unitprice) AS MarchRevenue FROM orderdetails WHERE orderid IN (SELECT orderid FROM orders WHERE orderdate BETWEEN '2023-03-01' AND '2023-03-31');",
      "SELECT SUM(COALESCE(od.quantity,0) * COALESCE(od.unitprice,0)) AS MarchRevenue FROM orderdetails od JOIN orders o ON od.orderid = o.orderid WHERE o.orderdate >= '2023-03-01' AND o.orderdate < '2023-04-01';"
    ],
    "A38": [
      "SELECT DISTINCT c.firstname, c.lastname FROM customers c JOIN orders o ON c.customerid = o.customerid JOIN orderdetails od ON o.orderid = od.orderid WHERE od.productid = 5;",
      "SELECT c.firstname, c.lastname FROM customers c, orders o, orderdetails od WHERE c.customerid = o.customerid AND o.orderid = od.orderid AND od.productid = 5;",
      "SELECT DISTINCT c.firstname, c.lastname FROM customers c JOIN orders o ON c.customerid = o.customerid JOIN orderdetails od ON o.orderid = od.orderid WHERE od.productid IN (5, 6, 7);",
      "SELECT c.firstname, c.lastname FROM customers c JOIN orders o ON c.customerid = o.customerid JOIN orderdetails od ON o.orderid = od.orderid WHERE od.productid = 5 GROUP BY c.firstname, c.lastname HAVING COUNT(*) > 1;",
      "SELECT c.firstname, c.lastname FROM customers c JOIN orders o ON c.customerid = o.customerid JOIN orderdetails od ON o.orderid = od.orderid WHERE od.productid = 5 AND o.orderdate >= '2023-01-01' GROUP BY c.firstname, c.lastname;"
    ],
    "A39": [
      "SELECT productname FROM products ORDER BY stockquantity DESC LIMIT 1;",
      "SELECT productname FROM products WHERE stockquantity = (SELECT MAX(stockquantity) FROM products);",
      "SELECT * FROM (SELECT productname, stockquantity FROM products ORDER BY stockquantity DESC) WHERE ROWNUM = 1;",
      "SELECT TOP 1 productname, stockquantity FROM products ORDER BY stockquantity DESC;",
      "SELECT productname FROM products WHERE stockquantity = (SELECT MAX(stockquantity) FROM products WHERE stockquantity IS NOT NULL);"
    ],
    "A40": [
      "SELECT AVG(TotalItems) FROM (SELECT orderid, SUM(quantity) AS TotalItems FROM orderdetails GROUP BY orderid) AS OrderTotals;",
      "SELECT AVG(ItemCount) FROM (SELECT orderid, COUNT(productid) AS ItemCount FROM orderdetails GROUP BY orderid) AS OrderSummary;",
      "SELECT AVG(quantity) FROM orderdetails;",
      "SELECT AVG(TotalQuantity) FROM (SELECT orderid, SUM(quantity) AS TotalQuantity FROM orderdetails GROUP BY orderid) AS OrderSums;",
      "SELECT AVG(SUM(quantity)) FROM orderdetails GROUP BY orderid;"
    ]
  },
  "Complicated": {
    "A41": [
      "WITH CustomerSpending AS (   SELECT        o.customerid,        SUM(od.quantity * od.unitprice) / COUNT(DISTINCT o.orderid) AS AvgOrderValue   FROM orders o   JOIN orderdetails od ON o.orderid = od.orderid   GROUP BY o.customerid ), OverallAverage AS (   SELECT AVG(AvgOrderValue) AS GlobalAvg FROM CustomerSpending ) SELECT c.firstname, cs.AvgOrderValue FROM CustomerSpending cs JOIN customers c ON cs.customerid = c.customerid CROSS JOIN OverallAverage WHERE cs.AvgOrderValue > OverallAverage.GlobalAvg;",
      "WITH CustomerAvg AS (   SELECT        o.customerid,       AVG(od.quantity * od.unitprice) AS AvgOrderValue   FROM orders o   JOIN orderdetails od ON o.orderid = od.orderid   GROUP BY o.customerid ), GlobalAvg AS (   SELECT AVG(AvgOrderValue) AS OverallAvg FROM CustomerAvg ) SELECT c.firstname, ca.AvgOrderValue FROM CustomerAvg ca JOIN customers c ON ca.customerid = c.customerid CROSS JOIN GlobalAvg WHERE ca.AvgOrderValue > GlobalAvg.OverallAvg;",
      "WITH RankedCustomers AS (   SELECT        c.customerid,       c.firstname,       c.lastname,       SUM(od.quantity * od.unitprice) AS TotalSpent,       RANK() OVER(ORDER BY SUM(od.quantity * od.unitprice) DESC) AS SpendingRank   FROM customers c   JOIN orders o ON c.customerid = o.customerid   JOIN orderdetails od ON o.orderid = od.orderid   GROUP BY c.customerid ) SELECT firstname, lastname, TotalSpent FROM RankedCustomers WHERE SpendingRank <= 10;",
      "WITH CustomerOrders AS (   SELECT        o.customerid,       COUNT(DISTINCT o.orderid) AS OrderCount,       SUM(od.quantity * od.unitprice) AS TotalSpent   FROM orders o   JOIN orderdetails od ON o.orderid = od.orderid   GROUP BY o.customerid ) SELECT c.firstname, c.lastname, co.OrderCount, co.TotalSpent FROM customers c JOIN CustomerOrders co ON c.customerid = co.customerid WHERE co.TotalSpent > (SELECT AVG(TotalSpent) FROM CustomerOrders);",
      "WITH MonthlySales AS (   SELECT       DATE_TRUNC('month', o.orderdate) AS SaleMonth,       SUM(od.quantity * od.unitprice) AS MonthlyRevenue   FROM orders o   JOIN orderdetails od ON o.orderid = od.orderid   GROUP BY SaleMonth ) SELECT   SaleMonth,   MonthlyRevenue,   SUM(MonthlyRevenue) OVER(ORDER BY SaleMonth) AS RunningTotal FROM MonthlySales;"
    ],
    "A42": [
      "SELECT c.categoryname, AVG(p.price) AS AvgCategoryPrice FROM categories c JOIN products p ON c.categoryid = p.categoryid GROUP BY c.categoryid HAVING AvgCategoryPrice > (SELECT AVG(price) FROM products);",
      "SELECT c.categoryname, AVG(unitprice) AS AvgCategoryPrice FROM categories c JOIN products p ON c.categoryid = p.categoryid GROUP BY c.categoryid HAVING AvgCategoryPrice > (SELECT AVG(unitprice) FROM products);",
      "WITH CategoryAvg AS (   SELECT        c.categoryid,       AVG(p.price) AS AvgCategoryPrice   FROM categories c   JOIN products p ON c.categoryid = p.categoryid   GROUP BY c.categoryid ) SELECT c.categoryname, ca.AvgCategoryPrice FROM CategoryAvg ca JOIN categories c ON ca.categoryid = c.categoryid WHERE ca.AvgCategoryPrice > (SELECT AVG(AvgCategoryPrice) FROM CategoryAvg);",
      "WITH PriceStats AS (   SELECT        c.categoryid,       AVG(p.price) AS AvgCategoryPrice,       MIN(p.price) AS MinPrice,       MAX(p.price) AS MaxPrice   FROM categories c   JOIN products p ON c.categoryid = p.categoryid   GROUP BY c.categoryid ) SELECT c.categoryname, ps.AvgCategoryPrice, ps.MinPrice, ps.MaxPrice FROM PriceStats ps JOIN categories c ON ps.categoryid = c.categoryid WHERE ps.AvgCategoryPrice > (SELECT AVG(AvgCategoryPrice) FROM PriceStats);",
      "SELECT c.categoryname, AVG(p.price) AS AvgCategoryPrice FROM categories c JOIN products p ON c.categoryid = p.categoryid GROUP BY c.categoryid HAVING COUNT(p.productid) > 5 AND AvgCategoryPrice > (SELECT AVG(price) FROM products);"
    ],
    "A43": [
      "WITH CustomerSpending AS (   SELECT        c.city,       c.firstname,       c.lastname,       SUM(od.quantity * od.unitprice) AS TotalSpent,       ROW_NUMBER() OVER(PARTITION BY c.city ORDER BY SUM(od.quantity * od.unitprice) DESC) AS city_rank   FROM customers c   JOIN orders o ON c.customerid = o.customerid   JOIN orderdetails od ON o.orderid = od.orderid   GROUP BY c.customerid ) SELECT city, firstname, lastname, TotalSpent FROM CustomerSpending WHERE city_rank <= 3;",
      "WITH CityRankings AS (   SELECT        c.city,       c.firstname,       c.lastname,       SUM(od.quantity * od.unitprice) AS TotalSpent,       RANK() OVER(PARTITION BY c.city ORDER BY SUM(od.quantity * od.unitprice) DESC) AS city_rank   FROM customers c   JOIN orders o ON c.customerid = o.customerid   JOIN orderdetails od ON o.orderid = od.orderid   GROUP BY c.customerid ) SELECT city, firstname, lastname, TotalSpent FROM CityRankings WHERE city_rank <= 3;",
      "WITH TopCustomers AS (   SELECT        c.customerid,       c.firstname,       c.lastname,       SUM(od.quantity * od.unitprice) AS TotalSpent,       RANK() OVER(ORDER BY SUM(od.quantity * od.unitprice) DESC) AS SpendingRank   FROM customers c   JOIN orders o ON c.customerid = o.customerid   JOIN orderdetails od ON o.orderid = od.orderid   GROUP BY c.customerid ) SELECT firstname, lastname, TotalSpent FROM TopCustomers WHERE SpendingRank <= 10;",
      "WITH RankedSpending AS (   SELECT        c.customerid,       SUM(od.quantity * od.unitprice) AS TotalSpent,       DENSE_RANK() OVER(ORDER BY SUM(od.quantity * od.unitprice) DESC) AS SpendingRank   FROM customers c   JOIN orders o ON c.customerid = o.customerid   JOIN orderdetails od ON o.orderid = od.orderid   GROUP BY c.customerid ) SELECT c.firstname, c.lastname, rs.TotalSpent FROM RankedSpending rs JOIN customers c ON rs.customerid = c.customerid WHERE rs.SpendingRank <= 10;",
      "WITH CityWiseSpending AS (   SELECT        c.city,       SUM(od.quantity * od.unitprice) AS TotalSpent   FROM customers c   JOIN orders o ON c.customerid = o.customerid   JOIN orderdetails od ON o.orderid = od.orderid   GROUP BY c.city ) SELECT city, SUM(TotalSpent) AS TotalSpending FROM CityWiseSpending GROUP BY city HAVING SUM(TotalSpent) > (SELECT AVG(TotalSpent) FROM CityWiseSpending);"
    ],
    "A44": [
      "WITH DailySales AS (   SELECT       DATE(o.orderdate) AS SaleDate,       SUM(od.quantity * od.unitprice) AS DailyRevenue   FROM orders o   JOIN orderdetails od ON o.orderid = od.orderid   WHERE o.orderdate >= '2023-12-01' AND o.orderdate < '2024-01-01'   GROUP BY SaleDate ) SELECT   SaleDate,   DailyRevenue,   SUM(DailyRevenue) OVER(ORDER BY SaleDate) AS RunningTotal FROM DailySales;",
      "WITH DailyRevenue AS (   SELECT       CAST(o.orderdate AS DATE) AS SaleDate,       SUM(od.quantity * od.unitprice) AS DailyRevenue   FROM orders o   JOIN orderdetails od ON o.orderid = od.orderid   WHERE o.orderdate >= '2023-12-01' AND o.orderdate < '2024-01-01'   GROUP BY CAST(o.orderdate AS DATE) ) SELECT   SaleDate,   DailyRevenue,   SUM(DailyRevenue) OVER(ORDER BY SaleDate) AS RunningTotal FROM DailyRevenue;",
      "WITH SalesData AS (   SELECT       DATE(o.orderdate) AS SaleDate,       SUM(od.quantity * od.unitprice) AS DailyRevenue   FROM orders o   JOIN orderdetails od ON o.orderid = od.orderid   WHERE o.orderdate >= '2023-12-01' AND o.orderdate < '2024-01-01'   GROUP BY DATE(o.orderdate) ) SELECT   SaleDate,   DailyRevenue,   SUM(DailyRevenue) OVER(ORDER BY SaleDate) AS RunningTotal FROM SalesData;",
      "WITH RevenueByDay AS (   SELECT       CONVERT(DATE, o.orderdate) AS SaleDate,       SUM(od.quantity * od.unitprice) AS DailyRevenue   FROM orders o   JOIN orderdetails od ON o.orderid = od.orderid   WHERE o.orderdate >= '2023-12-01' AND o.orderdate < '2024-01-01'   GROUP BY CONVERT(DATE, o.orderdate) ) SELECT   SaleDate,   DailyRevenue,   SUM(DailyRevenue) OVER(ORDER BY SaleDate) AS RunningTotal FROM RevenueByDay;",
      "WITH DailySales AS (   SELECT       DATE(o.orderdate) AS SaleDate,       SUM(od.quantity * od.unitprice) AS DailyRevenue   FROM orders o   JOIN orderdetails od ON o.orderid = od.orderid   WHERE o.orderdate >= '2023-12-01' AND o.orderdate < '2024-01-01'   GROUP BY DATE(o.orderdate) ) SELECT   SaleDate,   DailyRevenue,   SUM(DailyRevenue) OVER(ORDER BY SaleDate) AS RunningTotal FROM DailySales;"
    ],
    "A45": [
      "WITH RankedOrders AS (   SELECT        customerid,        orderdate,       LEAD(orderdate, 1) OVER(PARTITION BY customerid ORDER BY orderdate) AS NextOrderDate,       ROW_NUMBER() OVER(PARTITION BY customerid ORDER BY orderdate) AS order_num   FROM orders ) SELECT    customerid,   orderdate AS FirstOrder,   NextOrderDate AS SecondOrder,   DATEDIFF(NextOrderDate, orderdate) AS DaysBetween FROM RankedOrders WHERE order_num = 1 AND NextOrderDate IS NOT NULL;",
      "WITH OrderRanks AS (   SELECT        customerid,       orderdate,       LEAD(orderdate) OVER(PARTITION BY customerid ORDER BY orderdate) AS NextOrderDate,       ROW_NUMBER() OVER(PARTITION BY customerid ORDER BY orderdate) AS OrderRank   FROM orders ) SELECT    customerid,   orderdate AS FirstOrderDate,   NextOrderDate AS SecondOrderDate,   DATEDIFF(NextOrderDate, orderdate) AS DaysBetweenOrders FROM OrderRanks WHERE OrderRank = 1 AND NextOrderDate IS NOT NULL;",
      "WITH OrderSequence AS (   SELECT        customerid,       orderdate,       LEAD(orderdate) OVER(PARTITION BY customerid ORDER BY orderdate) AS NextOrderDate,       ROW_NUMBER() OVER(PARTITION BY customerid ORDER BY orderdate) AS Seq   FROM orders ) SELECT    customerid,   orderdate AS FirstOrderDate,   NextOrderDate AS SecondOrderDate,   DATEDIFF(NextOrderDate, orderdate) AS DaysBetween FROM OrderSequence WHERE Seq = 1 AND NextOrderDate IS NOT NULL;",
      "WITH CustomerOrders AS (   SELECT        customerid,       orderdate,       LEAD(orderdate) OVER(PARTITION BY customerid ORDER BY orderdate) AS NextOrderDate   FROM orders ) SELECT    customerid,   orderdate AS FirstOrderDate,   NextOrderDate AS SecondOrderDate,   DATEDIFF(NextOrderDate, orderdate) AS DaysBetween FROM CustomerOrders WHERE NextOrderDate IS NOT NULL;",
      "WITH OrderDiffs AS (   SELECT        customerid,       orderdate,       LEAD(orderdate) OVER(PARTITION BY customerid ORDER BY orderdate) AS NextOrderDate   FROM orders ) SELECT    customerid,   orderdate AS FirstOrderDate,   NextOrderDate AS SecondOrderDate,   DATEDIFF(NextOrderDate, orderdate) AS DaysBetween FROM OrderDiffs WHERE NextOrderDate IS NOT NULL;"
    ],
    "A46": [
      "SELECT c.customerid, c.firstname FROM customers c JOIN orders o ON c.customerid = o.customerid JOIN orderdetails od ON o.orderid = od.orderid WHERE od.productid = 5 -- Bought Product A AND EXISTS (   SELECT 1   FROM orderdetails od2   JOIN orders o2 ON od2.orderid = o2.orderid   WHERE o2.customerid = c.customerid AND od2.productid = 8 -- Also bought Product B ) GROUP BY c.customerid;",
      "SELECT c.customerid, c.firstname FROM customers c JOIN orders o ON c.customerid = o.customerid JOIN orderdetails od ON o.orderid = od.orderid WHERE od.productid = 5 AND EXISTS (   SELECT 1   FROM orderdetails od2   WHERE od2.orderid = o.orderid AND od2.productid = 8 ) GROUP BY c.customerid;",
      "SELECT c.customerid, c.firstname FROM customers c JOIN orders o ON c.customerid = o.customerid JOIN orderdetails od ON o.orderid = od.orderid WHERE od.productid = 5 AND EXISTS (   SELECT 1   FROM orderdetails od2   WHERE od2.orderid = o.orderid AND od2.productid = 8 ) GROUP BY c.customerid;",
      "SELECT c.customerid, c.firstname FROM customers c JOIN orders o ON c.customerid = o.customerid JOIN orderdetails od ON o.orderid = od.orderid WHERE od.productid = 5 AND EXISTS (   SELECT 1   FROM orderdetails od2   WHERE od2.orderid = o.orderid AND od2.productid = 8 ) GROUP BY c.customerid;",
      "SELECT c.customerid, c.firstname FROM customers c JOIN orders o ON c.customerid = o.customerid JOIN orderdetails od ON o.orderid = od.orderid WHERE od.productid = 5 AND EXISTS (   SELECT 1   FROM orderdetails od2   WHERE od2.orderid = o.orderid AND od2.productid = 8 ) GROUP BY c.customerid;"
    ],
    "A47": [
      "SELECT c.customerid, c.firstname FROM customers c JOIN orders o ON c.customerid = o.customerid JOIN orderdetails od ON o.orderid = od.orderid WHERE od.productid = 5 -- Bought Product A AND NOT EXISTS (   SELECT 1   FROM orderdetails od2   JOIN orders o2 ON od2.orderid = o2.orderid   WHERE o2.customerid = c.customerid AND od2.productid = 8 -- Did NOT buy Product B ) GROUP BY c.customerid;",
      "SELECT c.customerid, c.firstname FROM customers c JOIN orders o ON c.customerid = o.customerid JOIN orderdetails od ON o.orderid = od.orderid WHERE od.productid = 5 AND NOT EXISTS (   SELECT 1   FROM orderdetails od2   WHERE od2.orderid = o.orderid AND od2.productid = 8 ) GROUP BY c.customerid;",
      "SELECT c.customerid, c.firstname FROM customers c JOIN orders o ON c.customerid = o.customerid JOIN orderdetails od ON o.orderid = od.orderid WHERE od.productid = 5 AND NOT EXISTS (   SELECT 1   FROM orderdetails od2   WHERE od2.orderid = o.orderid AND od2.productid = 8 ) GROUP BY c.customerid;",
      "SELECT c.customerid, c.firstname FROM customers c JOIN orders o ON c.customerid = o.customerid JOIN orderdetails od ON o.orderid = od.orderid WHERE od.productid = 5 AND NOT EXISTS (   SELECT 1   FROM orderdetails od2   WHERE od2.orderid = o.orderid AND od2.productid = 8 ) GROUP BY c.customerid;",
      "SELECT c.customerid, c.firstname FROM customers c JOIN orders o ON c.customerid = o.customerid JOIN orderdetails od ON o.orderid = od.orderid WHERE od.productid = 5 AND NOT EXISTS (   SELECT 1   FROM orderdetails od2   WHERE od2.orderid = o.orderid AND od2.productid = 8 ) GROUP BY c.customerid;"
    ],
    "A48": [
      "WITH CategoryRevenue AS (   SELECT        c.categoryname,       SUM(od.quantity * od.unitprice) AS Revenue   FROM categories c   JOIN products p ON c.categoryid = p.categoryid   JOIN orderdetails od ON p.productid = od.productid   GROUP BY c.categoryname ), TotalRevenue AS (   SELECT SUM(Revenue) AS Total FROM CategoryRevenue ) SELECT   cr.categoryname,   cr.Revenue,   (cr.Revenue / tr.Total) * 100 AS PercentageOfTotal FROM CategoryRevenue cr CROSS JOIN TotalRevenue tr;",
      "WITH RevenueByCategory AS (   SELECT        c.categoryid,       SUM(od.quantity * od.unitprice) AS TotalRevenue   FROM categories c   JOIN products p ON c.categoryid = p.categoryid   JOIN orderdetails od ON p.productid = od.productid   GROUP BY c.categoryid ), OverallRevenue AS (   SELECT SUM(TotalRevenue) AS Total FROM RevenueByCategory ) SELECT   c.categoryname,   rbc.TotalRevenue,   (rbc.TotalRevenue / or.Total) * 100 AS RevenuePercentage FROM RevenueByCategory rbc JOIN categories c ON rbc.categoryid = c.categoryid CROSS JOIN OverallRevenue or;",
      "WITH CategorySales AS (   SELECT        c.categoryid,       SUM(od.quantity * od.unitprice) AS TotalSales   FROM categories c   JOIN products p ON c.categoryid = p.categoryid   JOIN orderdetails od ON p.productid = od.productid   GROUP BY c.categoryid ), TotalSales AS (   SELECT SUM(TotalSales) AS GrandTotal FROM CategorySales ) SELECT   c.categoryname,   cs.TotalSales,   (cs.TotalSales / ts.GrandTotal) * 100 AS SalesPercentage FROM CategorySales cs JOIN categories c ON cs.categoryid = c.categoryid CROSS JOIN TotalSales ts;",
      "WITH SalesData AS (   SELECT        c.categoryid,       SUM(od.quantity * od.unitprice) AS TotalSales   FROM categories c   JOIN products p ON c.categoryid = p.categoryid   JOIN orderdetails od ON p.productid = od.productid   GROUP BY c.categoryid ), OverallSales AS (   SELECT SUM(TotalSales) AS Total FROM SalesData ) SELECT   c.categoryname,   sd.TotalSales,   (sd.TotalSales / os.Total) * 100 AS SalesShare FROM SalesData sd JOIN categories c ON sd.categoryid = c.categoryid CROSS JOIN OverallSales os;",
      "WITH CategoryIncome AS (   SELECT        c.categoryid,       SUM(od.quantity * od.unitprice) AS TotalIncome   FROM categories c   JOIN products p ON c.categoryid = p.categoryid   JOIN orderdetails od ON p.productid = od.productid   GROUP BY c.categoryid ), GlobalIncome AS (   SELECT SUM(TotalIncome) AS Total FROM CategoryIncome ) SELECT   c.categoryname,   ci.TotalIncome,   (ci.TotalIncome / gi.Total) * 100 AS IncomePercentage FROM CategoryIncome ci JOIN categories c ON ci.categoryid = c.categoryid CROSS JOIN GlobalIncome gi;"
    ],
    "A49": [
      "SELECT   p.productid,   p.productname,   COUNT(DISTINCT od.orderid) AS OrderCount FROM products p JOIN orderdetails od ON p.productid = od.productid GROUP BY p.productid, p.productname ORDER BY OrderCount DESC LIMIT 1;",
      "SELECT TOP 1   p.productid,   p.productname,   COUNT(DISTINCT od.orderid) AS OrderCount FROM products p JOIN orderdetails od ON p.productid = od.productid GROUP BY p.productid, p.productname ORDER BY OrderCount DESC;",
      "SELECT   p.productid,   p.productname,   COUNT(DISTINCT od.orderid) AS OrderCount FROM products p JOIN orderdetails od ON p.productid = od.productid GROUP BY p.productid, p.productname HAVING OrderCount = (SELECT MAX(OrderCount) FROM (SELECT COUNT(DISTINCT od2.orderid) AS OrderCount FROM orderdetails od2 GROUP BY od2.productid) AS OrderCounts);",
      "SELECT   p.productid,   p.productname,   COUNT(DISTINCT od.orderid) AS OrderCount FROM products p JOIN orderdetails od ON p.productid = od.productid GROUP BY p.productid, p.productname HAVING OrderCount = (SELECT MAX(OrderCount) FROM (SELECT COUNT(*) AS OrderCount FROM orderdetails GROUP BY productid) AS OrderCounts);",
      "SELECT   p.productid,   p.productname,   COUNT(DISTINCT od.orderid) AS OrderCount FROM products p JOIN orderdetails od ON p.productid = od.productid GROUP BY p.productid, p.productname ORDER BY OrderCount DESC FETCH FIRST 1 ROW ONLY;"
    ],
    "A50": [
      "WITH CustomerSpending AS (   SELECT        c.customerid,       c.joindate,       SUM(od.quantity * od.unitprice) AS TotalSpent   FROM customers c   LEFT JOIN orders o ON c.customerid = o.customerid   LEFT JOIN orderdetails od ON o.orderid = od.orderid   GROUP BY c.customerid, c.joindate ) SELECT    customerid,   TotalSpent,   LAG(TotalSpent, 1, 0) OVER (ORDER BY joindate) AS PreviousCustomerSpending FROM CustomerSpending;",
      "WITH SpendingData AS (   SELECT        c.customerid,       c.joindate,       SUM(od.quantity * od.unitprice) AS TotalSpent   FROM customers c   LEFT JOIN orders o ON c.customerid = o.customerid   LEFT JOIN orderdetails od ON o.orderid = od.orderid   GROUP BY c.customerid, c.joindate ) SELECT    customerid,   TotalSpent,   LAG(TotalSpent) OVER (PARTITION BY customerid ORDER BY joindate) AS PreviousTotalSpent FROM SpendingData;",
      "WITH RankedSpending AS (   SELECT        c.customerid,       c.joindate,       SUM(od.quantity * od.unitprice) AS TotalSpent,       ROW_NUMBER() OVER (PARTITION BY c.customerid ORDER BY c.joindate) AS rn   FROM customers c   LEFT JOIN orders o ON c.customerid = o.customerid   LEFT JOIN orderdetails od ON o.orderid = od.orderid   GROUP BY c.customerid, c.joindate ) SELECT    customerid,   TotalSpent,   (SELECT TotalSpent FROM RankedSpending rs WHERE rs.customerid = RankedSpending.customerid AND rs.rn = 1) AS PreviousTotalSpent FROM RankedSpending WHERE rn = 2;",
      "WITH CustomerTotals AS (   SELECT        c.customerid,       SUM(od.quantity * od.unitprice) AS TotalSpent   FROM customers c   JOIN orders o ON c.customerid = o.customerid   JOIN orderdetails od ON o.orderid = od.orderid   GROUP BY c.customerid ) SELECT    c.customerid,   ct.TotalSpent,   (SELECT TotalSpent FROM CustomerTotals WHERE customerid = c.customerid) AS PreviousTotalSpent FROM customers c JOIN CustomerTotals ct ON c.customerid = ct.customerid;",
      "WITH SpendingLag AS (   SELECT        c.customerid,       SUM(od.quantity * od.unitprice) AS TotalSpent,       LAG(SUM(od.quantity * od.unitprice), 1, 0) OVER (PARTITION BY c.customerid ORDER BY c.joindate) AS PreviousTotalSpent   FROM customers c   JOIN orders o ON c.customerid = o.customerid   JOIN orderdetails od ON o.orderid = od.orderid   GROUP BY c.customerid, c.joindate ) SELECT    customerid,   TotalSpent,   PreviousTotalSpent FROM SpendingLag;"
    ],
    "A51": [
      "SELECT orderid, COUNT(DISTINCT productid) AS UniqueProducts FROM orderdetails GROUP BY orderid HAVING UniqueProducts > 5;",
      "SELECT orderid, COUNT(*) AS UniqueProducts FROM orderdetails GROUP BY orderid HAVING UniqueProducts > 5;",
      "SELECT orderid, COUNT(1) AS UniqueProducts FROM orderdetails GROUP BY orderid HAVING UniqueProducts > 5;",
      "SELECT orderid, COUNT(DISTINCT CASE WHEN productid IS NOT NULL THEN productid END) AS UniqueProducts FROM orderdetails GROUP BY orderid HAVING UniqueProducts > 5;",
      "SELECT orderid, SUM(CASE WHEN productid IS NOT NULL THEN 1 ELSE 0 END) AS UniqueProducts FROM orderdetails GROUP BY orderid HAVING UniqueProducts > 5;"
    ],
    "A52": [
      "WITH DailySales AS (   SELECT        DATE(orderdate) AS SaleDate,       SUM(od.quantity * od.unitprice) AS DailyRevenue   FROM orders o   JOIN orderdetails od ON o.orderid = od.orderid   GROUP BY SaleDate ) SELECT   SaleDate,   DailyRevenue,   AVG(DailyRevenue) OVER(       ORDER BY SaleDate       ROWS BETWEEN 2 PRECEDING AND CURRENT ROW   ) AS ThreeDayMovingAvg FROM DailySales;",
      "WITH RevenueData AS (   SELECT        DATE(orderdate) AS SaleDate,       SUM(od.quantity * od.unitprice) AS DailyRevenue   FROM orders o   JOIN orderdetails od ON o.orderid = od.orderid   GROUP BY DATE(orderdate) ) SELECT   SaleDate,   DailyRevenue,   AVG(DailyRevenue) OVER(       ORDER BY SaleDate       ROWS BETWEEN 2 PRECEDING AND CURRENT ROW   ) AS MovingAverageRevenue FROM RevenueData;",
      "WITH SalesData AS (   SELECT        DATE(orderdate) AS SaleDate,       SUM(od.quantity * od.unitprice) AS DailyRevenue   FROM orders o   JOIN orderdetails od ON o.orderid = od.orderid   GROUP BY DATE(orderdate) ) SELECT   SaleDate,   DailyRevenue,   AVG(DailyRevenue) OVER(       ORDER BY SaleDate       ROWS BETWEEN 2 PRECEDING AND CURRENT ROW   ) AS AvgRevenueLast3Days FROM SalesData;",
      "WITH DailyRevenue AS (   SELECT        DATE(orderdate) AS SaleDate,       SUM(od.quantity * od.unitprice) AS DailyRevenue   FROM orders o   JOIN orderdetails od ON o.orderid = od.orderid   GROUP BY DATE(orderdate) ) SELECT   SaleDate,   DailyRevenue,   AVG(DailyRevenue) OVER(       ORDER BY SaleDate       ROWS BETWEEN 2 PRECEDING AND CURRENT ROW   ) AS RevenueMovingAvg FROM DailyRevenue;",
      "WITH SalesSummary AS (   SELECT        DATE(orderdate) AS SaleDate,       SUM(od.quantity * od.unitprice) AS DailyRevenue   FROM orders o   JOIN orderdetails od ON o.orderid = od.orderid   GROUP BY DATE(orderdate) ) SELECT   SaleDate,   DailyRevenue,   AVG(DailyRevenue) OVER(       ORDER BY SaleDate       ROWS BETWEEN 2 PRECEDING AND CURRENT ROW   ) AS ThreeDayAvgRevenue FROM SalesSummary;"
    ]
  }
}